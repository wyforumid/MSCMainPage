<html ng-app="mainApp">
<head>
	<title>MSC</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap-theme.min.css">
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
</head>
<body class="index">
	<div class="jumbotron trans" ng-controller="loginCtrl">
		<h1>
			Have a good day, Colleagues
		</h1>
		<h4>
			Welcome to the Internal Web.
		</h4>
		<p>
			<!-- <button class="btn btn-primary btn-lg">Public</button>
			<button class="btn btn-primary btn-lg">User</button> -->
			<div class="form-inline" role="form">
			<!-- <form class="form-inline" role="form" action="/API/user/LOGIN" method="POST"> -->
				<div class="form-group">
					<label class="sr-only" for="loginName">
						Login Name: 
					</label>
					<input type="text" ng-model="userName" name="userName"  class="form-control" id="loginName" placeholder="Enter login Name">
				</div>
				<div class="form-group" ng-hide="userInfo.isLogin">
					<label class="sr-only" for="loginPWD">
						Password: 
					</label>
					<input type="password" name="password" ng-model="password" class="form-control" id="loginPWD" placeholder="Enter password">
				</div>
				<div class="form-group">
					<button class="btn btn-primary btn-lg" ng-click="login()">Login</button>
					<!-- <input type="submit" class="btn btn-primary btn-lg" value="Login"> -->
					<button class="btn btn-primary btn-lg" ng-click="registUser();">Regist User</button>
				</div>
			<!-- </form> -->
			</div>
			<div class="form-group">
				<a href="javascript:void(0);" ng-click="forgotPassword();">Forgot your password?</a>
			</div>
		</p>
	</div>
	<script type="text/javascript" src="/javascripts/jquery-2.1.1.js"></script>
	<script type="text/javascript" src="/javascripts/bootstrap.min.js"></script>
	<script type="text/javascript" src="/javascripts/angular.js"></script>
	<script type="text/javascript" src="/javascripts/angular-route.js"></script>
	<script type="text/javascript" src="/javascripts/ng-grid.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.cookie.js"></script>
	<script type="text/javascript">
	// angular.module('mainApp',['ngRoute'])
	// .config(['$routeProvider',function($routeProvider){

	// }])
angular.module('mainApp',[])
.controller('loginCtrl',function($scope,$http,$rootScope){
	$rootScope.userInfo = {
		name:'Guest',
		isLogin:false
	};
	$scope.userName = '';
	$scope.password = '';

	$scope.forgotPassword = function(){
		window.location = 'main#/USER/ForgetPassword';
	};



	$scope.login = function() {

		$http({
			method:'POST',
			url:'/API/user/LOGIN',
			data:{
				userName:$scope.userName,
				password:$scope.password
			},
			cache:false
		}).success(function(data, status) {
			if(data == '1'){
				window.location='/main';
			}else{
				alert('Wrong login name or wrong password');
			}
				// switch (data[0].result) {
				// 	case 1:
				// 	$.cookie('user',JSON.stringify({ userName: $scope.userName, cacheId:data[0].cacheId }), {expire:7});
				// 	window.location = '/main';
				// 	break;
				// 	default:
				// 	alert(data[0].msg);	
				// 	break;
				// }

			}).error(function(data, status) {
				alert(data);
			});
		};


		$scope.registUser = function(){
			window.location = 'main#/USER/Regist';
		};

	})
</script>
</body>
</html>
